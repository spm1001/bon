{"id": "arc-bibobi", "type": "outcome", "title": "Arc handles multi-agent and multi-branch usage safely", "brief": {"why": "Arc is used across worktrees, branches, and machines by multiple Claude agents. Several subtle failure modes exist: silent wrong-winner on merge dedup, session paths not canonicalized (symlinks break scoping), and waiting_for can reference archived/nonexistent IDs that will never auto-unblock.", "what": "1. Smarter dedup in load_items — warn on duplicates, prefer most-recently-modified 2. Canonicalize session paths with os.path.realpath() 3. Warn in cmd_wait when waiting_for looks like an arc ID but isn't found in active items", "done": "load_items warns on duplicate IDs. Session scoping resolves symlinks. arc wait on a nonexistent ID-shaped string produces a visible warning. Existing tests still pass."}, "status": "done", "order": 7, "created_at": "2026-02-14T21:31:43Z", "created_by": "spm1001", "done_at": "2026-02-14T21:40:53Z"}
{"id": "arc-bujoti", "type": "action", "title": "Add arc update command", "brief": {"why": "After editing arc source, the installed version (uv tool install) doesn't change — users must remember to re-run uv tool install ~/Repos/arc. This is the main friction point and the incantation is easy to forget.", "what": "1. Add update subcommand to cli.py that runs uv tool install on the source repo 2. Detect repo path from package metadata or __file__ 3. Add tests 4. Document in README", "done": "arc update re-installs from source, prints confirmation with version, works from any directory"}, "status": "done", "parent": "arc-paleca", "order": 2, "created_at": "2026-02-13T08:13:13Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Add update subcommand to cli.py that runs uv tool install on the source repo", "Detect repo path from package metadata or __file__", "Add tests", "Document in README"], "current": 4}, "done_at": "2026-02-13T08:16:39Z"}
{"id": "arc-delica", "type": "action", "title": "Cache get_creator() and add consistent --quiet flag", "brief": {"why": "get_creator() shells out to git config on every call — unnecessary overhead. --quiet only works on arc new but not arc done/edit/wait/unwait, creating inconsistency documented in FIELD_REPORT_quiet_flag.md.", "what": "1. Cache get_creator() result in a module-level variable after first call 2. Add --quiet/-q to arc done, arc edit, arc wait, arc unwait via add_output_flags 3. When -q is set, print only the item ID (or nothing for done)", "done": "get_creator() runs git at most once per process. arc done arc-xyz -q prints just 'arc-xyz'. Tests cover quiet mode on each command."}, "status": "done", "parent": "arc-takeje", "order": 4, "created_at": "2026-02-14T21:32:56Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-14T22:25:37Z"}
{"id": "arc-dikode", "type": "action", "title": "Update stale docs to match reality", "brief": {"why": "CLAUDE.md says 17 commands/249 tests/~1000 LOC. SPEC.md says 'no dependencies' but pyproject.toml has pyyaml. Drift erodes trust in documentation.", "what": "1. Update CLAUDE.md stats (LOC, test count, command count) 2. SPEC.md: either acknowledge pyyaml as migration-only dependency or note it as a known deviation", "done": "CLAUDE.md numbers match wc -l output and pytest count. SPEC.md dependency section is honest."}, "status": "done", "parent": "arc-jegeza", "order": 2, "created_at": "2026-02-14T21:32:06Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Update CLAUDE.md stats (LOC, test count, command count)", "SPEC.md: either acknowledge pyyaml as migration-only dependency or note it as a known deviation"], "current": 2, "session": "/home/modha/Repos/arc"}, "done_at": "2026-02-14T21:38:13Z"}
{"id": "arc-dipisu", "type": "action", "title": "Warn on duplicate IDs in load_items and prefer most-recently-modified", "brief": {"why": "merge=union can keep both old and new versions of an edited item. Currently load_items takes last-occurrence, but 'last' is git's positional choice — the wrong version can silently win.", "what": "1. Track seen IDs during load_items; when a duplicate is found, warn to stderr 2. When deduplicating, compare timestamps (done_at > created_at) and keep most recent 3. Improve conflict-marker detection — if a line starts with <<<<<<< or >>>>>>>, warn specifically about unresolved merge", "done": "Duplicate ID in JSONL produces a visible warning. Timestamp-based dedup picks the right winner. Git conflict markers produce a specific diagnostic. Tests cover all three cases."}, "status": "done", "parent": "arc-bibobi", "order": 1, "created_at": "2026-02-14T21:32:15Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Track seen IDs during load_items; when a duplicate is found, warn to stderr", "When deduplicating, compare timestamps (done_at > created_at) and keep most recent", "Improve conflict-marker detection — if a line starts with <<<<<<< or >>>>>>>, warn specifically about unresolved merge"], "current": 3, "session": "/home/modha/Repos/arc"}, "done_at": "2026-02-14T21:40:50Z"}
{"id": "arc-dopete", "type": "outcome", "title": "Garde indexes Amp sessions, not just Claude Code", "brief": {"why": "garde only scans ~/.claude/projects/ for claude_code sessions. Amp uses a different storage path. As work moves to Amp on kube, session history becomes invisible to garde search — only 5 claude_code sessions indexed vs many Amp sessions unindexed.", "what": "1. Identify where Amp stores session data on disk 2. Add an Amp scanner to garde (alongside the existing claude_code scanner) 3. Test that garde search finds content from Amp sessions", "done": "uv run garde recent --all shows Amp sessions. uv run garde search finds content from Amp conversations."}, "status": "open", "order": 10, "created_at": "2026-02-14T21:48:38Z", "created_by": "spm1001"}
{"id": "arc-fadado", "type": "outcome", "title": "Gemini skill is a thin command reference, not a duplicate of Claude SKILL.md", "brief": {"why": "gemini/skills/arc/SKILL.md risks diverging from the canonical arc/SKILL.md. Maintaining two full skill files for different agents doubles the update burden. The workflow knowledge (draw-down, vocabulary) is agent-agnostic but the hooks/CC-specific parts aren't relevant to Gemini.", "what": "1. Reduce gemini/skills/arc/SKILL.md to a command reference + link to canonical docs 2. Keep agent-agnostic workflow guidance (draw-down, draw-up, vocabulary) 3. Remove Claude-specific sections (UserPromptSubmit hook, CC anti-patterns)", "done": "Gemini skill is under 100 lines. Core workflow knowledge is preserved. No Claude-specific content in the Gemini version."}, "status": "done", "order": 9, "created_at": "2026-02-14T21:33:06Z", "created_by": "spm1001", "done_at": "2026-02-14T22:29:36Z"}
{"id": "arc-hadoka", "type": "action", "title": "Add comment in _most_recent_timestamp linking to content_hash field report", "brief": {"why": "load_items dedup uses done_at/created_at but not updated_at (which doesn't exist yet). When updated_at is added per FIELD_REPORT_content_hash.md, the dedup logic needs updating too. A comment now prevents a future Claude from missing the connection.", "what": "1. Add a comment in _most_recent_timestamp() referencing FIELD_REPORT_content_hash.md and noting updated_at should be included when added", "done": "Comment exists in storage.py linking the two concerns."}, "status": "done", "parent": "arc-takeje", "order": 5, "created_at": "2026-02-14T21:48:45Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-14T22:25:37Z"}
{"id": "arc-hetoko", "type": "outcome", "title": "Verify kube CC env.PATH works in Guéridon sessions", "brief": {"why": "Added env.PATH to kube ~/.claude/settings.json so Claudes can find arc/uv in ~/.local/bin. Tested via SSH with explicit PATH exports but haven't confirmed CC actually inherits the setting when spawning shells.", "what": "1. Start a Guéridon session on kube 2. Ask Claude to run 'which arc' and 'arc --version' 3. Confirm it finds arc without any PATH workarounds", "done": "A Guéridon Claude on kube can run arc commands without PATH issues."}, "status": "done", "order": 3, "created_at": "2026-02-13T14:02:00Z", "created_by": "spm1001", "done_at": "2026-02-14T22:29:53Z"}
{"id": "arc-jamemu", "type": "outcome", "title": "Spot-check CC GitHub issue links in field report", "brief": {"why": "FIELD_REPORT_context_bomb.md cites 10 specific GitHub issue numbers from web search research. Web search can hallucinate URLs. If we share this externally or reference it in a bug report, broken links undermine credibility.", "what": "1. Visit each GitHub issue URL in the field report 2. Verify it exists and matches the description 3. Remove or correct any broken links", "done": "Every GitHub link in FIELD_REPORT_context_bomb.md resolves to a real issue matching its description."}, "status": "open", "order": 4, "created_at": "2026-02-13T14:02:03Z", "created_by": "spm1001"}
{"id": "arc-jaroco", "type": "action", "title": "Canonicalize session paths with os.path.realpath()", "brief": {"why": "Session scoping uses os.getcwd() which doesn't resolve symlinks. Two terminals accessing the same repo via different paths (symlink, trailing slash) get different session keys, breaking the serial constraint.", "what": "1. Replace os.getcwd() with os.path.realpath(os.getcwd()) in cmd_work and cmd_step 2. Apply same fix in cmd_show --current", "done": "Symlinked paths resolve to the same session key. Existing session_tactical tests still pass."}, "status": "done", "parent": "arc-bibobi", "order": 2, "created_at": "2026-02-14T21:32:21Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Replace os.getcwd() with os.path.realpath(os.getcwd()) in cmd_work and cmd_step", "Apply same fix in cmd_show --current"], "current": 2, "session": "/home/modha/Repos/arc"}, "done_at": "2026-02-14T21:39:01Z"}
{"id": "arc-jazofo", "type": "action", "title": "Diagnose the CC file-watch injection mechanism", "brief": {"why": "We know items.jsonl modification causes context bloat, but not which CC mechanism is responsible — could be file-watch (CC monitors project files and injects changes), PostToolUse hook, or the Bash tool itself echoing file contents. Need to know before we can fix.", "what": "1. Check CC docs/source for file-change notification behaviour 2. Test: does editing a random file via Edit tool also inject its contents? 3. Test: does editing via Bash (echo >>) also inject? 4. Check if .gitignore exclusions suppress the watch 5. Document the mechanism", "done": "We know exactly which CC feature injects file contents into system-reminders, and whether .gitignore controls it."}, "status": "done", "parent": "arc-volesu", "order": 1, "created_at": "2026-02-13T12:58:44Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Check CC docs/source for file-change notification behaviour", "Test: does editing a random file via Edit tool also inject its contents?", "Test: does editing via Bash (echo >>) also inject?", "Check if .gitignore exclusions suppress the watch", "Document the mechanism"], "current": 5, "session": "/Users/modha/Repos/arc"}, "done_at": "2026-02-13T13:03:25Z"}
{"id": "arc-jegeza", "type": "outcome", "title": "All tests pass and docs match reality", "brief": {"why": "HEAD has 2 failing tests (argparse nargs=* + --force conflict in arc work) and CLAUDE.md stats are stale (says 249 tests, 17 commands, ~1000 LOC — actual is 263 tests, 2009 LOC). Broken tests erode trust in the suite.", "what": "1. Fix arc work argparse conflict so positional steps work alongside --force 2. Update CLAUDE.md stats to match reality 3. Reconcile SPEC.md 'no dependencies' claim with PyYAML in pyproject.toml", "done": "uv run pytest passes 100%. CLAUDE.md numbers match wc -l and pytest count. SPEC.md acknowledges pyyaml or migration drops it."}, "status": "done", "order": 6, "created_at": "2026-02-14T21:31:34Z", "created_by": "spm1001", "done_at": "2026-02-14T21:38:17Z"}
{"id": "arc-jolone", "type": "outcome", "title": "Clean up fresh-frog test project on kube", "brief": {"why": "Created ~/Repos/fresh-frog on kube as a throwaway test for the context bomb investigation. Contains a git repo with fake arc items. Will accumulate if not cleaned up.", "what": "1. SSH to kube 2. rm -rf ~/Repos/fresh-frog", "done": "Directory gone, no stale test projects on kube."}, "status": "open", "order": 5, "created_at": "2026-02-13T14:02:06Z", "created_by": "spm1001"}
{"id": "arc-nebele", "type": "action", "title": "Extract migration code into src/arc/migrate.py", "brief": {"why": "migrate_to_draft and migrate_from_draft are ~280 LOC of rarely-used code in cli.py, inflating it to 1414 lines. Migration is a distinct concern from the core command loop.", "what": "1. Move migrate_to_draft() and migrate_from_draft() to src/arc/migrate.py 2. Keep cmd_migrate() in cli.py as a thin dispatch 3. Move the yaml import to migrate.py (only place it's used)", "done": "cli.py is ~280 lines shorter. Migration tests still pass. yaml import is isolated to migrate.py."}, "status": "done", "parent": "arc-takeje", "order": 1, "created_at": "2026-02-14T21:32:36Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-14T22:25:37Z"}
{"id": "arc-paleca", "type": "outcome", "title": "Arc is frictionless to install and update across projects", "brief": {"why": "Currently requires uv tool install from repo path, doesn't auto-update on source changes, skill symlink was missing, no guidance for cross-project use. Every new machine or repo is a papercut.", "what": "1. Document the install story (uv tool install, PATH, editable workaround) 2. Add 'arc self-update' or similar convenience command 3. Ensure skill directory ships with installable package or has clear symlink instructions 4. Consider uv tool install -e when uv supports it", "done": "New user can go from clone to working arc+skill in under 60 seconds, updates don't require remembering incantations"}, "status": "done", "order": 1, "created_at": "2026-02-12T20:35:08Z", "created_by": "spm1001", "done_at": "2026-02-13T08:18:42Z"}
{"id": "arc-rajiwe", "type": "action", "title": "Single version source via importlib.metadata", "brief": {"why": "__version__ is hardcoded in cli.py and duplicated in pyproject.toml. They've drifted before (commit 1714bfd fixed a mismatch). importlib.metadata reads the installed version from pyproject.toml, eliminating the duplication.", "what": "1. Replace __version__ = '0.4.0' in cli.py with importlib.metadata.version('arc') 2. Update --version flag to use it 3. Remove the hardcoded string", "done": "arc --version returns the version from pyproject.toml. No hardcoded version string in cli.py. Existing version tests pass."}, "status": "done", "parent": "arc-takeje", "order": 3, "created_at": "2026-02-14T21:32:49Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-14T22:25:37Z"}
{"id": "arc-redazo", "type": "action", "title": "Replace error()+sys.exit with ArcError exception", "brief": {"why": "error() in storage.py calls sys.exit(1), making the code untestable in-process and unusable as a library. Every error path terminates the process.", "what": "1. Create ArcError(Exception) in storage.py 2. Change error() to raise ArcError instead of sys.exit 3. Catch ArcError in main(), print to stderr, exit 1 4. Update tests that check returncode==1 (should still work via subprocess)", "done": "error() raises ArcError. main() catches it. All existing tests pass unchanged. A new test demonstrates catching ArcError in-process."}, "status": "done", "parent": "arc-takeje", "order": 2, "created_at": "2026-02-14T21:32:43Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-14T22:25:37Z"}
{"id": "arc-rutodi", "type": "action", "title": "Warn when waiting_for references an unresolvable ID", "brief": {"why": "arc wait arc-xyz 'arc-archived-item' sets waiting_for to an ID that lives in the archive. arc done will never find it to auto-unblock. The user gets silently stuck.", "what": "1. In cmd_wait, if the reason string matches the {prefix}-{hash} pattern, check active items for it 2. If not found, emit a warning: 'arc-foo not found in active items — waiting_for may never resolve automatically' 3. Don't error — free-text reasons are valid per spec", "done": "arc wait with a nonexistent ID-shaped reason produces a warning. arc wait with free text does not warn. Tests cover both cases."}, "status": "done", "parent": "arc-bibobi", "order": 3, "created_at": "2026-02-14T21:32:29Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["In cmd_wait, if the reason string matches the {prefix}-{hash} pattern, check active items for it", "If not found, emit a warning: 'arc-foo not found in active items — waiting_for may never resolve automatically'", "Don't error — free-text reasons are valid per spec"], "current": 3, "session": "/home/modha/Repos/arc"}, "done_at": "2026-02-14T21:39:41Z"}
{"id": "arc-seseke", "type": "action", "title": "Fix README install docs", "brief": {"why": "README recommends symlinking to .venv/bin/arc which breaks on venv recreate. Doesn't mention uv tool install (the actual method) or skill symlink setup. New users hit confusion immediately.", "what": "1. Replace Add to PATH section with uv tool install as primary method 2. Add skill symlink instruction 3. Update Quick Start to use arc instead of uv run arc 4. Note the editable-install gap and arc update workaround", "done": "README install section matches reality: uv tool install, skill symlink, no stale .venv references"}, "status": "done", "parent": "arc-paleca", "order": 1, "created_at": "2026-02-13T08:13:06Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Replace Add to PATH section with uv tool install as primary method", "Add skill symlink instruction", "Update Quick Start to use arc instead of uv run arc", "Note the editable-install gap and arc update workaround"], "current": 4}, "done_at": "2026-02-13T08:14:21Z"}
{"id": "arc-takeje", "type": "outcome", "title": "Arc codebase is well-structured for future development", "brief": {"why": "cli.py is 1414 lines with migration code (~280 LOC) sharing space with hot-path commands. error() calls sys.exit(1) making unit testing impossible. Storage functions are CWD-coupled. Version is duplicated between cli.py and pyproject.toml. get_creator() shells out to git on every invocation. --quiet flag only works on arc new.", "what": "1. Extract migration into src/arc/migrate.py 2. Replace error()+sys.exit with ArcError exception caught in main() 3. Thread root:Path through storage functions 4. Single version source via importlib.metadata 5. Cache get_creator() per process 6. Consistent --quiet across mutation commands", "done": "cli.py under 1200 LOC. Tests can catch ArcError without subprocess. Storage functions accept optional root parameter. arc --version reads from package metadata. get_creator runs git at most once. arc done -q works."}, "status": "done", "order": 8, "created_at": "2026-02-14T21:31:52Z", "created_by": "spm1001", "done_at": "2026-02-14T22:25:37Z"}
{"id": "arc-tetohu", "type": "action", "title": "Fix argparse conflict between positional steps and --force in arc work", "brief": {"why": "arc work <id> --force 'step1' 'step2' fails with 'unrecognized arguments' because nargs='*' on the steps positional doesn't consume args after --force. This breaks 2 tests on HEAD: test_work_force_restarts and test_work_cross_session_error.", "what": "1. Change steps from positional nargs=* to a flag like --steps or use -- separator convention 2. Update the 2 failing tests 3. Verify no other tests break", "done": "uv run pytest passes 100%. arc work <id> --force 'A' 'B' creates tactical with steps A and B."}, "status": "done", "parent": "arc-jegeza", "order": 1, "created_at": "2026-02-14T21:31:59Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Change steps from positional nargs=* to a flag like --steps or use -- separator convention", "Update the 2 failing tests", "Verify no other tests break"], "current": 3, "session": "/home/modha/Repos/arc"}, "done_at": "2026-02-14T21:36:14Z"}
{"id": "arc-volesu", "type": "outcome", "title": "Modifying items.jsonl doesn't bomb the context window", "brief": {"why": "CC's file-change notification fires when items.jsonl is modified during a session. Since all items live in one file, every edit triggers a system-reminder containing the entire file. A 76-item file was ~19k tokens injected per turn, causing premature compaction and a 3x answer loop. Gets worse as items grow. Discovered 2026-02-10 on kube via Guéridon — see handoff 7d693c34.", "what": "1. Diagnose exactly which CC mechanism triggers the injection (file-watch, PostToolUse hook, or something else) 2. Evaluate mitigations: split storage into per-item files, use .gitignore-style exclusion from CC watch, move tactical to separate file, or cap what the hook emits 3. Implement chosen mitigation 4. Verify on a real session that modifying items no longer bloats context", "done": "An arc session that files 5+ items doesn't inject items.jsonl content into system-reminders. Context usage stays proportional to conversation, not to item count."}, "status": "done", "order": 2, "created_at": "2026-02-13T12:50:30Z", "created_by": "spm1001", "done_at": "2026-02-13T13:46:53Z"}
